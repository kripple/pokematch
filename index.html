<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <meta name="description" content="Test your memory with Pokématch!" />
    <meta
      name="keywords"
      content="Pokémon memory game, concentration game, memory matching game, JavaScript memory game, Pokémon app game, brain training game"
    />
    <meta name="robots" content="index, follow" />
    <link rel="icon" href="/src/images/master-ball.png" />
    <title>Pokématch</title>

    <script>
      (function setDataTheme() {
        function storageAvailable(type) {
          try {
            const storage = window[type];
            const testKey = '__temp';
            storage.setItem(testKey, testKey);
            storage.removeItem(testKey);
            return true;
          } catch (error) {
            return false;
          }
        }
        function getItem(key) {
          return storageAvailable('localStorage') && localStorage.getItem(key);
        }
        if (getItem('theme') === 'light') {
          document.documentElement.setAttribute('data-theme', 'light');
        } else {
          document.documentElement.setAttribute('data-theme', 'dark');
        }
      })();
    </script>

    <link rel="stylesheet" href="/src/css/theme.css" />
    <link rel="stylesheet" href="/src/css/theme-toggle.css" />
    <link rel="stylesheet" href="/src/css/root.css" />
    <link rel="stylesheet" href="/src/css/concentration.css" />
    <link rel="stylesheet" href="/src/css/fonts/fonts.css" />
    <link rel="stylesheet" href="/src/css/game.css" />
  </head>
  <body>
    <input aria-hidden="true" id="theme-toggle" type="checkbox" />
    <div class="app theme">
      <header class="header">
        <div class="contents">
          <div class="title">Gotta match them all!</div>

          <label
            aria-label="theme toggle"
            class="theme-toggle-label"
            for="theme-toggle"
            tabindex="0"
          >
            <div class="label-dark">Dark</div>
            <div class="theme-toggle"></div>
            <div class="label-light">Light</div>
          </label>
        </div>
      </header>

      <main class="main">
        <div class="contents">
          <div id="game-board"></div>
          <!-- <div id="new-game-element"></div> -->
        </div>
      </main>

      <footer class="footer">
        <!-- <div class="author-credit">
          Icons made by
          <a
            href="https://www.flaticon.com/authors/roundicons-freebies"
            rel="noopener noreferrer"
            target="_blank"
            title="Flat Icons"
          >
            Flat Icons
          </a>
          from
          <a
            href="https://www.flaticon.com/"
            rel="noopener noreferrer"
            target="_blank"
            title="Flaticon"
          >
            www.flaticon.com
          </a>
        </div> -->
      </footer>
    </div>

    <!-- constants -->
    <script src="/src/js/constants.js"></script>

    <!-- models -->
    <script src="/src/js/card.js"></script>
    <script src="/src/js/deck.js"></script>

    <!-- controllers -->
    <script src="/src/js/game.js"></script>

    <!-- runner -->
    <script src="/src/js/runner.js"></script>

    <!-- tests -->
    <!-- <script src="/src/js/test.js"></script> -->

    <!-- attributions -->
    <script>
      console.log(
        'Icons by FlatIcon - https://www.flaticon.com/packs/pokemon-go',
      );
    </script>

    <script>
      (function saveThemePreference() {
        function storageAvailable(type) {
          try {
            const storage = window[type];
            const testKey = '__temp';
            storage.setItem(testKey, testKey);
            storage.removeItem(testKey);
            return true;
          } catch (error) {
            return false;
          }
        }
        const available = storageAvailable('localStorage');
        function setItem(key, value) {
          if (!available) return;
          localStorage.setItem(key, value);
        }
        const checkbox = document.getElementById('theme-toggle');
        if (!(checkbox instanceof HTMLInputElement)) {
          console.info('missing theme toggle');
          return;
        }
        const savedTheme = document.documentElement.getAttribute('data-theme');
        if (savedTheme) {
          if (savedTheme === 'light') {
            checkbox.click();
          }
          document.documentElement.removeAttribute('data-theme');
        }
        checkbox.addEventListener('change', (event) => {
          const target = event.target;
          if (!(target instanceof HTMLInputElement)) {
            console.info('unexpected input');
            return;
          }
          setItem('theme', target.checked ? 'light' : 'dark');
        });
      })();
    </script>
  </body>
</html>
